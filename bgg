<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <script src="/js/plugin/popper.min.js"></script>
  <script src="/webjars/jquery/3.3.1/jquery.min.js"></script>
  <script src="/webjars/jquery-ui/1.12.1/jquery-ui.js"></script>
  <script src="/webjars/bootstrap/5.1.3/js/bootstrap.min.js"></script>
  <script src="/webjars/font-awesome/6.2.0/js/all.js"></script>
  <script src="/webjars/datatables/1.13.2/js/jquery.dataTables.min.js"></script>
  <script src="/js/plugin/alertify.js"></script>
  <script src="/js/plugin/alertify.min.js"></script>
  <script src="/js/client_table_page.js"></script>
  <script src="/js/client_form/validators.js"></script>
  <script src="/js/client_form/constants.js"></script>
  <script src="/js/client_form/display_style_changers.js"></script>
  <script src="/js/client_form/form_fillers.js"></script>

  <link href="/media/jira-logo-scaled.png" rel="icon" type="image/png">
  <link href="/webjars/font-awesome/6.2.0/css/all.css" rel="stylesheet">
  <link href="/webjars/jquery-ui/1.12.1/jquery-ui.css" rel="stylesheet">
  <link href="/css/alertify.css" rel="stylesheet">
  <link href="/css/alertify.min.css" rel="stylesheet">
  <link href="/css/alertify.rtl.css" rel="stylesheet">
  <link href="/css/alertify.rtl.min.css" rel="stylesheet">
  <link href="/css/themes/bootstrap.css" rel="stylesheet">
  <link href="/webjars/bootstrap/5.1.3/css/bootstrap.min.css"
        rel="stylesheet"/>
  <link href="/css/style.css" rel="stylesheet">
  <link href="/css/datatables.css" rel="stylesheet">


  <title>Реестр подключений</title>
</head>
<body>
<input id="userId" th:value="${userId}" type="hidden">
<input id="isAdmin" th:value="${isAdmin}" type="hidden">
<div class="container-fluid mx-5 col-auto border border-success mt-5" id="table-container">
  <div class="container-fluid mt-3 mb-2">
    <div class="row justify-content-end">
      <h5 class="col-1 me-auto">Assistant</h5>
      <div class="col-9 position-relative">
        <h6 id="personalInfo" th:text="${personalInfo}" class="mt-3 text-end"></h6>
      </div>
      <div class="col-auto">
        <a class="btn btn-outline-success" href="/sso/logout" title="Выйти">
          <i class="fas fa-sign-out"></i>
        </a>
      </div>
    </div>
  </div>
  <ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item" role="presentation">
      <button class="nav-link active" id="client-tab" data-bs-toggle="tab" data-bs-target="#client-list" type="button"
              role="tab" aria-controls="client-list" aria-selected="true">Подключения
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button class="nav-link" id="role-tab" data-bs-toggle="tab" data-bs-target="#role-list" type="button"
              role="tab" aria-controls="role-list" aria-selected="false">Глобальные роли
      </button>
    </li>
  </ul>
  <div class="tab-content" id="myTabContent">
    <div class="tab-pane fade show active" role="tabpanel" aria-labelledby="client-tab" id="client-list">
      <div class="container-fluid border border-success">
        <div class="row my-3">
          <div class="col-2">
            <a class="btn btn-success" href="/client" role="button">Новое подключение</a>
          </div>
        </div>
      </div>
      <div class="container-fluid border border-success table-responsive my-3">
        <table class="table table-bordered border-success mt-3" id="data-table">
          <thead>
          <tr>
            <th scope="col">Наименование подключенной АС</th>
            <th scope="col">Client ID</th>
            <th scope="col">Кто пользуется АС</th>
            <th scope="col">Дата публикации</th>
            <th scope="col">Статус</th>
            <th th:if="${isAdmin == true}" scope="col">Имя пользователя</th>
            <th scope="col">Список клиентских ролей</th>
            <th scope="col">Действия</th>
          </tr>
          </thead>
          <tbody id="clients-table-body">
          </tbody>
        </table>
      </div>
    </div>
    <div class="tab-pane fade" role="tabpanel" aria-labelledby="role-tab" id="role-list">
      <div class="container-fluid border border-success">
        <div class="row my-3">
          <div class="col-2">
            <button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#roleModal">
              Новая роль
            </button>
          </div>
          <div class="col-7"></div>
        </div>
      </div>
      <div class="container-fluid border border-success my-3">
        <table class="table table-bordered border-success mt-3" id="role-table">
          <thead>
          <tr>
            <th scope="col">Наименование</th>
            <th scope="col">Описание</th>
            <th scope="col">Кому доступна роль</th>
            <th scope="col">Дата публикации</th>
            <th scope="col">Действия</th>
          </tr>
          </thead>
          <tbody id="roles-table-body">
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
<div class="modal fade" id="roleModal" tabindex="-1" aria-labelledby="roleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Новая роль</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="role-form">
          <div class="mb-3">
            <label for="role-name" class="col-form-label">Наименование роли<span
                    style="color: red">*</span></label>
            <input type="text" class="form-control border border-success" required id="role-name"
                   onkeyup="checkIfTextValid(this, inputAllowedRegex)">
          </div>
          <div class="mb-3">
            <label for="role-description" class="col-form-label">Описание роли<span
                    style="color: red">*</span></label>
            <input class="form-control border border-success" id="role-description" required type="text">
          </div>
          <div class="mb-3">
            <label class="form-label" for="realm-select">Кому будет доступна данная роль<span
                    style="color: red">*</span></label>
            <select class="form-select border border-success" required id="realm-select">
              <option></option>
              <option value="internal-assistant-idm" id="INTERNAL">Только сотрудники АО "Банк ДОМ.РФ"</option>
              <option value="external-assistant-idm" id="EXTERNAL"> Сотрудники сторонних юр. лиц и возможно сотрудники
                АО
                "Банк ДОМ.РФ"
              </option>
              <option value="rtl-assistant-idm" id="RTL">Физ. лица - клиенты АО "Банк ДОМ.РФ" и возможно сотрудники
                Банка
              </option>
              <option value="internal-assistant-idm" id="INTERNAL_BANK">Только внутренние АС Банка</option>
              <option value="external-assistant-idm" id="EXTERNAL_BANK">Как внешние, так и внутренние АС Банка</option>
              сотрудники Банка
            </select>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Закрыть</button>
        <button class="btn btn-outline-success" id="save-role-btn" type="button">Сохранить</button>
      </div>
    </div>
  </div>
</div>
</body>
<div class="row" id="spinner" style="display: none; height: 1000px; width: 100%">
  <div class="spinner-grow text-success mx-auto my-auto" role="status">
    <span class="sr-only"></span>
  </div>
</div>

<div aria-hidden="true" aria-labelledby="contourMigrateModalLabel" class="modal fade" data-bs-backdrop="static"
     data-bs-keyboard="false" id="contourMigrateModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="contourMigrateLabel">Перенос подключения</h5>
        <button aria-label="Close" class="btn-close" data-bs-dismiss="modal" type="button"></button>
      </div>
      <div class="modal-body">
        <form id="migrate-form">
          <input aria-label="" hidden id="clientIdInModal">
          <div class="mb-3">
            <label class="form-label" for="availableContoursSelect">Выберите нужный контур <span
                    style="color: red">*</span> </label>
            <select class="form-select border-success border" id="availableContoursSelect">

            </select>
          </div>
          <div class="mb-3">
            <label class="form-label" for="informationSystemSelect">Выберите родительскую ИС <span
                    style="color: red">*</span> </label>
            <select class="form-select border-success border" id="informationSystemSelect">

            </select>
          </div>
          <div class="mb-3">
            <label class="form-label" for="systemHost">Укажите владельца системы</label>
            <input class="form-control border border-success" id="systemHost" type="text">
          </div>
          <div class="mb-3">
            <label class="form-label" for="itManager">Укажите менеджера ИТ</label>
            <input class="form-control border border-success" id="itManager" type="text">
          </div>
          <div class="mb-3">
            <label class="form-label" for="criticalLevel">Укажите уровень критичности
              системы</label>
            <input class="form-control border border-success" id="criticalLevel" type="text">
          </div>
          <div class="mb-3">
            <label class="form-label" for="creatioNumber">Укажите номер обращения в Creatio</label>
            <input class="form-control border border-success" id="creatioNumber" type="text">
          </div>
          <div class="mb-3">
            <label class="form-label" for="login">Логин <span style="color: red">*</span></label>
            <input class="form-control border border-success" id="login" required type="text">
          </div>
          <div class="mb-3">
            <label class="form-label" for="password">Пароль <span style="color: red">*</span></label>
            <input class="form-control border border-success" id="password" required type="password">
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline-secondary" data-bs-dismiss="modal" type="button">Закрыть</button>
        <button class="btn btn-outline-success" id="publishToOtherContour" type="button">
          Перенести
        </button>
      </div>
    </div>
  </div>
</div>
</html>
